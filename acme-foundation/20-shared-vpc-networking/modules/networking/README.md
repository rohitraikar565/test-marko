# networking
This root module sets up shared VPCs in the host projects.

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:-----:|
| shared\_vpcs | Map of shared VPCs that you want created | <pre>map(object({<br>    host_project                           = string<br>    private_service_cidr                   = string // CIDR range for private service networking. Used for Cloud SQL and other managed services in the Shared Vpc.<br>    private_service_connect_ip             = string //The internal IP to be used as the private service connect endpoint in the Shared VPC<br>    subnets                                = list(map(string))<br>    domain                                 = string // The DNS name of peering managed zone, for instance 'example.com.'. Must end with a period.<br>    routing_mode                           = optional(string, "GLOBAL")<br>    secondary_ranges                       = optional(map(list(object({ range_name = string, ip_cidr_range = string }))), {})<br>    routes                                 = optional(list(map(string)), [])<br>    delete_default_internet_gateway_routes = optional(bool, false)<br>    mtu                                    = optional(number, 0)<br>    firewall_enable_logging                = optional(bool, false)<br>    allow_all_egress_ranges                = optional(list(string), []) // List of ranges to allow all egress traffic to<br>    allow_all_ingress_ranges               = optional(list(string), []) // List of ranges to allow all ingress traffic from<br>    dns_enable_inbound_forwarding          = optional(bool, true)<br>    dns_enable_logging                     = optional(bool, true)<br>    access_context_manager_policy_name     = optional(string, null)<br>    egress_policies = optional(list(object({<br>      from = any,<br>      to   = any,<br>    })), [])<br>    ingress_policies = optional(list(object({<br>      from = any,<br>      to   = any,<br>    })), [])<br>    restricted_services = optional(list(string), [])<br>    vpc_access_members  = optional(list(string), [])<br><br>    # Type: list(object), with fields:<br>    # - name (string, required): Name of the NAT.<br>    # - nat_ip_allocate_option (string, optional): How external IPs should be allocated for this NAT. Defaults to MANUAL_ONLY if nat_ips are set, else AUTO_ONLY.<br>    # - source_subnetwork_ip_ranges_to_nat (string, optional): How NAT should be configured per Subnetwork. Defaults to ALL_SUBNETWORKS_ALL_IP_RANGES.<br>    # - nat_ips (list(number), optional): Self-links of NAT IPs.<br>    # - min_ports_per_vm (number, optional): Minimum number of ports allocated to a VM from this NAT.<br>    # - max_ports_per_vm (number, optional): Maximum number of ports allocated to a VM from this NAT. This field can only be set when enableDynamicPortAllocation is enabled.<br>    # - udp_idle_timeout_sec (number, optional): Timeout (in seconds) for UDP connections. Defaults to 30s if not set.<br>    # - icmp_idle_timeout_sec (number, optional): Timeout (in seconds) for ICMP connections. Defaults to 30s if not set.<br>    # - tcp_established_idle_timeout_sec (number, optional): Timeout (in seconds) for TCP established connections. Defaults to 1200s if not set.<br>    # - tcp_transitory_idle_timeout_sec (number, optional): Timeout (in seconds) for TCP transitory connections. Defaults to 30s if not set.<br>    # - log_config (object, optional):<br>    #    - filter: Specifies the desired filtering of logs on this NAT. Defaults to "ALL".<br>    # - subnetworks (list(objects), optional):<br>    #   - name (string, required): subnetwork name to NAT.<br>    #   - source_ip_ranges_to_nat (string, required): List of options for which source IPs in the subnetwork should have NAT enabled.<br>    #   - secondary_ip_range_names (string, optional): List of the secondary ranges of the subnetwork that are allowed to use NAT.<br>    nats = optional(map(object({<br>      region                             = string<br>      nat_ip_allocate_option             = optional(string, "AUTO_ONLY")<br>      source_subnetwork_ip_ranges_to_nat = optional(string, "ALL_SUBNETWORKS_ALL_IP_RANGES")<br>      nat_ips                            = optional(list(string), [])<br>      min_ports_per_vm                   = optional(number, 0)<br>      max_ports_per_vm                   = optional(number, 0)<br>      udp_idle_timeout_sec               = optional(number, 30)<br>      icmp_idle_timeout_sec              = optional(number, 30)<br>      tcp_established_idle_timeout_sec   = optional(number, 1200)<br>      tcp_transitory_idle_timeout_sec    = optional(number, 30)<br>      log_config = optional(object({<br>        enable = optional(bool, false)<br>        filter = optional(string, "ALL")<br>      }), {})<br>      subnetworks = optional(list(object({<br>        name                     = string<br>        source_ip_ranges_to_nat  = list(string)<br>        secondary_ip_range_names = optional(list(string), [])<br>      })), [])<br>    })), {})<br>  }))<br></pre> | n/a | yes |
| terraform\_service\_account | The service account id used by Terraform Cloud to access GCP. This is set in 01-administration/terraform.tfvars | `any` | n/a | yes |
| tfc\_organization | The TFC organization name | `any` | n/a | yes |
| tfc\_workspace\_for\_host\_project | The TFC workspace name from which to get the state | `any` | n/a | yes |
| workload\_identity\_pool\_provider\_id | GCP workload identity pool provider ID. Set this value in your workspace after the initial deployement | `string` | n/a | yes |

## Outputs

| Name | Description |
|------|-------------|
| vpc | Shared VPCs information |
| vpc\_service\_perimeter | VPC Service Permiter |
